% -*- coding: utf-8 -*-
\documentclass[a4paper,10pt,DIV=16]{scrartcl}  
\usepackage{ucs} 
\usepackage{array}
\usepackage[utf8x]{inputenc}                   
\usepackage[T1]{fontenc}
\usepackage{lmodern}                        
\usepackage[english]{babel} 
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage[pdftex]{graphicx}
\usepackage{graphicx,amsfonts,amssymb,amsmath,amsthm}
\usepackage{multirow}
\usepackage{hyperref}
\usepackage[normalem]{ulem}
\hypersetup{colorlinks=true,hypertexnames=false}
\usepackage{setspace}
\usepackage{booktabs}
\usepackage[]{tcolorbox}
\usepackage{paralist}
\usepackage{tikz}
\usepackage{pgfplots}

\subject{Response to the reviewers}
\title{Large-scale feature selection with Gaussian mixture models for the classification of high dimensional remote sensing images}
\date{\today}
\author{Adrien Lagrange \and Mathieu Fauvel \and Manuel Grizonnet}

\newcommand{\rev}[1]{\textcolor{magenta}{#1}}
%%% Definition of the boxes
\newtcolorbox[auto counter,number within=section]{revbox}[1][]{%
colback=red!5!white,colframe=red!50!white,fonttitle=\sffamily\bfseries,
title=Comment~\thetcbcounter: #1}
\newtcolorbox[auto counter,number within=section]{resbox}[1][]{%
colback=blue!5!white,colframe=blue!5!white,title=Response~:,coltitle=black,fonttitle=\sffamily\bfseries}

\begin{document}
\maketitle

We have revised  the paper taking into account the  comments raised by
the reviewers.   We provide an  item-by-item response detailed  in the
following.   We hope  that this  improved  paper is  now suitable  for
publication  in  {\sc  Special Issue on Computational Imaging for Earth Sciences}.   We would  like  to  thank  the
anonymous reviewers for their dedication in reviewing our work and for
their constructive comments.

For clarity,  the modification appear  in \textcolor{magenta}{magenta}
in the revised paper.


\section{Reviewer 1}

\begin{revbox}
In Algorithm 3, a threshold EPS\_FLT on eigenvalues is used to prevent numerical instability. It’s not clear how the authors select the proper value for this threshold. And how does this threshold influence the classification accuracy?

  \begin{resbox}
    In order to influence as less as possible the classification accuracy, the threshold has been set as small as possible. The smallest possible float number is define by the computer architecture (in our case 64bits) and C++ specifications. The C++ documentation states that epsilon is the \emph{difference between 1 and the least value greater than 1 that is representable}(\url{http://www.cplusplus.com/reference/cfloat/}).
    This thresholding can be seen as a ridge regularization when applied to eigenvalues. 
  \end{resbox}

\end{revbox}

\begin{revbox}
  The authors show the experimental results on two different types of hyper-dimensional images, which is very good. But I have some doubts on the construction of the second high dimensional cube where 191 features are constructed based on the low dimensional RGBIR images. Are these features simply used for the purpose of increasing the data dimensionality? Or are there benefits in terms of classification accuracy?
  \begin{resbox}
    The interest of this second data cube is first to test the algorithm in a different context. In particular, the algorithm applied to this second dataset should be seen as a method to learn the most relevant kind of features and the best parameters to extract those features.

    In the first dataset, only spectral features has been considered and in the particular context of hyperspectral imaging which imply contiguous features highly correlated.
    
    (reponse bof à revoir et developper mais c'est un debut)
  \end{resbox}
\end{revbox}


\begin{revbox}
  In Fig. 5, the optimal number of variables are selected if the criterion stops to increase significantly. It is unclear to me how to make this selection. For example in Fig. 5, I would pick the optimal number of variables to be 7 instead of 18 which the authors suggest, since after 7 variables I do not observe a significant increase. Maybe plotting the discrete derivative of criteria together with Fig. 5 can help in the explanation.
  \begin{resbox}
  The value of the derivative of criterion is compared to a user-defined threshold. The first time the value reaches below the threshold correspond to the number of selected variables. The derivative for the example presented on Fig. 5 of the paper is presented in Figure~\ref{fig:deriv}.
  With the same example, 7 features gives a kappa of $0.620$ and 18 features a kappa of $0.657$.

  \end{resbox}
\end{revbox}

\begin{figure}[!ht]
  \centering
  \begin{tikzpicture}
    \begin{axis}[ymin=0,ymax=0.25,grid,axis x line=left,axis y line=left,xlabel={\# variables},ylabel={Derivative of\\Cohen's kappa},ylabel style={align=center},yticklabel style={/pgf/number format/fixed,/pgf/number format/precision=3}]
      \addplot[thick,black] table[x expr=\coordindex,y=deriv] {derivate_criterion_1000spl_aisa.txt};
      \draw[thick,red] (axis cs:18,\pgfkeysvalueof{/pgfplots/ymin}) -- (axis cs:18,\pgfkeysvalueof{/pgfplots/ymax});
      \draw[thick,black] (axis cs:24,\pgfkeysvalueof{/pgfplots/ymin}) -- (axis cs:24,\pgfkeysvalueof{/pgfplots/ymax});
    \end{axis};
  \end{tikzpicture}
  \caption{Derivative of criterion (kappa) in function of the number of selected variables for first trial with Aisa dataset with 500 samples by class. Red vertical line is the retained number of variables and black vertical line is the maximum of the criterion.\label{fig:deriv}}
\end{figure}


\begin{revbox}
  Following the question 3, why choosing the optimal number of variables based on the increase of criterion instead of the highest value?
  \begin{resbox}
    We also considered this possibility and it is a choice available in the code of the OTB module we provide. But taking the maximum appears not to be the optimal choice in the sense that the algorithm selects sometimes more variables than necessary. Sometimes, at a given point, the best new selected variable is one which contains no information (for example one whose contribution is thresholded by EPS\_FLT) because all others decrease the criterion value. If it happens several times, it can lead to a final drop of the criterion. The algorithm then tries to counterbalance the drop and regains the original maximum but can be slightly higher. Figure~\ref{fig:crit-evol} illustrated this case.
    The problem is that we introduce a few irrelevant features and we want to avoid that if possible. This case appears more often with the second dataset but we choose to use the same method for both dataset.
  \end{resbox}
\end{revbox}

\begin{figure}[!t]
  \centering
  \begin{tikzpicture}
    \begin{axis}[ymin=0.2,ymax=0.9,grid,axis x line=left,axis y line=left,xlabel={\# variables},ylabel={Cohen's kappa}]
      \addplot[thick,black] table[x=nb,y=crit] {criterion_1000spl.txt};
    \end{axis};
  \end{tikzpicture}
  \caption{Criterion evolution (kappa) in function of the number of selected variables for first trial with Potsdam dataset with 1000 samples by class.\label{fig:crit-evol}}
\end{figure}

\begin{revbox}
  In the experiment with Aisa dataset, although several numbers of training samples are tested, the number of training samples seems carefully selected by the authors to show the cases where the GMM classifiers perform better. I guess when a larger number of samples are trained, the random forest will have a higher classification rate. And when a smaller number of samples are used, the KNN will have a shorter training time. The GMM only wins in the classification time regardless of the sample number. It’ll be good to show these cases.
  \begin{resbox}
    It is true that we can try with fewer samples. We tried with 50 samples by class and it leads to the same behavior than with 250 samples (see Table~\ref{tab:aisa-otbsimu}).

    But in the case of a larger training set is not possible to test with the chosen validation method. We use an equal number of samples in each class and 50\% of the samples are used for test. Thus, as the less represented class contains 2107 samples, we are limited to 1053 samples by class with this dataset. Nevertheless, the second dataset illustrates the case and we also add the following comment in the paper to make it clear that RF could perform better with more samples:
    \emph{Random Forest has similar performance in term of classification rate with 1000 samples \rev{ and one could expect to get a better classification rate with RF if more samples were available}.}
  \end{resbox}
\end{revbox}

\begin{table}[!t]
    \centering
    \caption{Average classification accuracy 20 trials (standard deviation in parenthesis).\label{tab:aisa-otbsimu}}
    \begin{tabular}{lcccc}\toprule
         & \multicolumn{4}{c}{\bfseries Cohen's kappa} \\ \cmidrule{2-5}
        \# samples by class & 50 & 250 & 500 & 1000 \\ \midrule

        GMM SFS kappa &  0.612 (0.028) & {\bfseries 0.678 (0.029)} & {\bfseries 0.687 (0.029)} & {\bfseries 0.699 (0.028)} \\
        GMM SFS JM &     0.622 (0.026) & {\bfseries 0.685 (0.030)} & {\bfseries 0.689 (0.030)} & {\bfseries 0.701 (0.029)} \\
        GMM SFFS JM &    0.622 (0.026) & {\bfseries 0.685 (0.030)} & {\bfseries 0.689 (0.030)} & {\bfseries 0.701 (0.029)} \\
        GMM ridge &      0.597 (0.035) & 0.611 (0.040) & 0.620 (0.036) & 0.642 (0.034) \\
        KNN &            0.481 (0.054) & 0.551 (0.035) & 0.563 (0.033) & 0.574 (0.030) \\
        Random Forest &  0.555 (0.031) & 0.645 (0.026) & 0.673 (0.023) & {\bfseries 0.693 (0.023)} \\
        \bottomrule
    \end{tabular}
\end{table}

\begin{revbox}
  Correct some typos, for example:
  \begin{enumerate}
    \item In Proposition 2, in the sentence after the covariance matrix equation, I guess it should be ``u\_c'' instead of ``v\_c''.
    \item Grammar mistakes such as ``a buildings''.
  \end{enumerate}
  \begin{resbox}
    % Thank you for the careful reading.
    NB:

    no $v_c$ after prop 2...

    building corrected. Need to correct english at the end
  \end{resbox}
\end{revbox}

\section{Reviewer 2}
\begin{revbox}
  In section III-A, 5 criterion functions are proposed. With 2 feature selection methods (SFS and SFFS), there should be 10 possible configurations. However, in the experimental parts (page 14, line 21-24), results of only three configurations are shown. The authors said “other configurations have been investigated and performs either equally or lower in terms of classification accuracy.” I would suggest that the authors either show the results of more configurations or not introducing those unrelated criterion functions.
  \begin{resbox}
    see Table~\ref{tab:aisa-otbsimu-all}
  \end{resbox}
\end{revbox}

    \begin{table}[!t]
        \centering
        \caption{Average classification accuracy 20 trials with all configurations of criterion and method (standard deviation in parenthesis).\label{tab:aisa-otbsimu-all}}
        \begin{tabular}{lccc}\toprule
             & \multicolumn{3}{c}{\bfseries Cohen's kappa} \\ \cmidrule{2-4}
            \# samples by class & 250 & 500 & 1000 \\ \midrule

            GMM SFS JM &    0.685 (0.030) & 0.689 (0.030) & 0.701 (0.029) \\
            GMM SFS divKL &    &&\\
            GMM SFS kappa & 0.678 (0.029) & 0.687 (0.029) & 0.699 (0.028) \\
            GMM SFS OA &    &&\\
            GMM SFS F1mean &    &&\\
            GMM SFFS JM &   0.685 (0.030) & 0.689 (0.030) & 0.701 (0.029) \\
            GMM SFFS divKL &   &&\\
            GMM SFFS kappa &   &&\\
            GMM SFFS OA &   &&\\
            GMM SFFS F1mean &   &&\\
            \bottomrule
        \end{tabular}
    \end{table}

\begin{revbox}
  Only Cohen’s Kappa is utilized to analyze the classification accuracy. The experimental results would be more persuasive if other criterion functions are utilized as well. I am interested to see how different methods’ performance varies under different criterion functions.
  \begin{resbox}
    see Table~\ref{tab:aisa-otbsimu-othereval}
  \end{resbox}
\end{revbox}

    \begin{table}[!t]
        \centering
        \caption{Average classification accuracy 20 trials evaluated with overall accuracy and mean of F1-score (standard deviation in parenthesis).\label{tab:aisa-otbsimu-othereval}}
        \begin{tabular}{lcccccc}\toprule
             & \multicolumn{3}{c}{\bfseries Overall Accuracy} & \multicolumn{3}{c}{\bfseries F1-mean} \\ \cmidrule{2-7}
            \# samples by class & 250 & 500 & 1000  & 250 & 500 & 1000 \\ \midrule

            GMM SFS kappa & & & & & & \\
            GMM SFS JM &    & & & & & \\
            GMM SFFS JM &   & & & & & \\
            GMM ridge &     & & & & & \\
            KNN &           & & & & & \\
            Random Forest & & & & & & \\
            \bottomrule
        \end{tabular}
    \end{table}

\begin{revbox}
  According to Table IV in page 16. GMM SFS JM outperforms GMM SFS kappa a little bit under the kappa criterion. Since GMM SFS kappa updates the features according to the kappa criterion while GMM SFS JM updates the features according to the JM criterion, shouldn’t GMM SFS kappa outperforms GMM SFS JM under the kappa criterion? Or is there some explanation to it?
  \begin{resbox}

  \end{resbox}
\end{revbox}

\begin{revbox}
  In Table VI and Table VII, the \# of selected features are different for different proposed methods. And the classification performance drops when the \# of selected features decreases. According to Algorithm 2 and Algorithm 3, the \# of selected features should be equal to maxVarNb. So why the \# of selected features are different for different proposed methods? The comparison is not fair to me if the \# of selected features are different. The authors should also show the \# of selected features in Table IV or Table V as well.
  \begin{resbox}

  \end{resbox}
\end{revbox}

\begin{revbox}
  A reference or an explanation should be made in Page 1, line 36 regarding the curse of dimensionality
  \begin{resbox}

  \end{resbox}
\end{revbox}

\section{Reviewer 3}


\begin{revbox}
  Although the method seems promising, there are some significant issues the authors should address to. The key novelty and contribution of this technique is unfortunately unclear. The authors dedicate a lot of space in explaining already known mathematical formulations of the Gaussian Mixture Models and the feature selection techniques, in comparison with their proposed scheme.
  \begin{resbox}
    We totally agree that some mathematical formulations we used are already known. Nevertheless, we think that these formulations in this particular context has not been exploited so far. The results of our experiment shows that the proposed algorithm has the advantage to be very efficient in term of processing time with a fairly reasonable cost in term of classification accuracy. It has to be noticed that compared to similar methods using Gaussian Mixture model, no additional hypothesis are made on the covariance matrix which is tractable only because of the efficient implementation.
  \end{resbox}
\end{revbox}

\begin{revbox}
  Additionally, critical references are missing, such as:
  \begin{enumerate}
  \item K. Karalas, G. Tsagkatakis, M. Zervakis, and P. Tsakalides, "Land Classification Using Remotely Sensed Data: Going Multi-Label," IEEE Transactions on Geoscience and Remote Sensing, 2016, doi: 10.1109/TGRS.2016.2520203
  \item K. Karalas, G. Tsagkatakis, M. Zervakis, and P. Tsakalides. "Deep learning for multi-label land cover classification", in SPIE Remote Sensing, Toulouse
  \end{enumerate}

  \begin{resbox}
    After reading with interest this two references, we fail to see the link between these publications and our submission except for the type of data used to test algorithms.

    First reference reviews ways to assign several labels to one sample and so performs spectral unmixing. Second reference focus on the same topic but develop a deep learning approach. Although very interesting, we do not address the subject of multi-labeling in our work.

    According to these observations, we choose to respectfully disagree with the reviewer and take the decision not to add a digression to cite these references.
  \end{resbox}
\end{revbox}

\begin{revbox}
  Another drawback is that the English language is poorly written, since it contains several critical syntax and typographical errors. As a result, some parts of the text are unclarified and misunderstood.
  \begin{resbox}

  TODO

  \end{resbox}
\end{revbox}
 

\section{Auxillary data}
\label{sec:auxillary}


\end{document}
